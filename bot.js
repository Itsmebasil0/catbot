/* Copyright (C) 2020 Yusuf Usta.
Licensed under the  GPL-3.0 License;
you may not use this file except in compliance with the License.
WhatsAsena - Yusuf Usta
*/

const fs = require("fs");
const path = require("path");
const events = require("./events");
const chalk = require('chalk');
const config = require('./config');
const {WAConnection, MessageOptions, MessageType, Mimetype, Presence} = require('@adiwajshing/baileys');
const {Message, StringSession, Image, Video} = require('./SHAMOWLE/');
const { DataTypes } = require('sequelize');
const { getMessage } = require("./plugins/sql/greetings");
const axios = require('axios');
const got = require('got');

// Sql
const WhatsAsenaDB = config.DATABASE.define('WhatsAsena', {
    info: {
      type: DataTypes.STRING,
      allowNull: false
    },
    value: {
        type: DataTypes.TEXT,
        allowNull: false
    }
});

fs.readdirSync('./plugins/sql/').forEach(plugin => {
    if(path.extname(plugin).toLowerCase() == '.js') {
        require('./plugins/sql/' + plugin);
    }
});

const plugindb = require('./plugins/sql/plugin');

// Yalnızca bir kolaylık. https://stackoverflow.com/questions/4974238/javascript-equivalent-of-pythons-format-function //
String.prototype.format = function () {
    var i = 0, args = arguments;
    return this.replace(/{}/g, function () {
      return typeof args[i] != 'undefined' ? args[i++] : '';
   });
};
if (!Date.now) {
    Date.now = function() { return new Date().getTime(); }
}

Array.prototype.remove = function() {
    var what, a = arguments, L = a.length, ax;
    while (L && this.length) {
        what = a[--L];
        while ((ax = this.indexOf(what)) !== -1) {
            this.splice(ax, 1);
        }
    }
    return this;
};

async function whatsAsena () {
    await config.DATABASE.sync();
    var StrSes_Db = await WhatsAsenaDB.findAll({
        where: {
          info: 'StringSession'
        }
    });
    
    
    const conn = new WAConnection();
    conn.version = [3,3234,9];
    const Session = new StringSession();

    conn.logger.level = config.DEBUG ? 'debug' : 'warn';
    var nodb;

    if (StrSes_Db.length < 1) {
        nodb = true;
        conn.loadAuthInfo(Session.deCrypt(config.SESSION)); 
    } else {
        conn.loadAuthInfo(Session.deCrypt(StrSes_Db[0].dataValues.value));
    }

    conn.on ('credentials-updated', async () => {
        console.log(
            chalk.blueBright.italic('✅ Login information updated!')
        );

        const authInfo = conn.base64EncodedAuthInfo();
        if (StrSes_Db.length < 1) {
            await WhatsAsenaDB.create({ info: "StringSession", value: Session.createStringSession(authInfo) });
        } else {
            await StrSes_Db[0].update({ value: Session.createStringSession(authInfo) });
        }
    })    

    conn.on('connecting', async () => {
        console.log(`${chalk.green.bold('Whats')}${chalk.blue.bold('Asena')}
${chalk.white.bold('Version:')} ${chalk.red.bold(config.VERSION)}
${chalk.blue.italic('ℹ️ Connecting to WhatsApp...')}`);
    });
    

    conn.on('open', async () => {
        console.log(
            chalk.green.bold('✅ Login successful!')
        );

        console.log(
            chalk.blueBright.italic('⬇️ Installing external plugins...')
        );

        var plugins = await plugindb.PluginDB.findAll();
        plugins.map(async (plugin) => {
            if (!fs.existsSync('./plugins/' + plugin.dataValues.name + '.js')) {
                console.log(plugin.dataValues.name);
                var response = await got(plugin.dataValues.url);
                if (response.statusCode == 200) {
                    fs.writeFileSync('./plugins/' + plugin.dataValues.name + '.js', response.body);
                    require('./plugins/' + plugin.dataValues.name + '.js');
                }     
            }
        });

        console.log(
            chalk.blueBright.italic('⬇️Installing plugins...')
        );

        fs.readdirSync('./plugins').forEach(plugin => {
            if(path.extname(plugin).toLowerCase() == '.js') {
                require('./plugins/' + plugin);
            }
        });

        console.log(
            chalk.green.bold('✅ SHAMOWLE working!')
        );
        await new Promise(r => setTimeout(r, 1100));

        if (config.WORKTYPE == 'public') {
            if (config.LANG == 'TR' || config.LANG == 'AZ') {

                if (conn.user.jid === '@s.whatsapp.net') {

                    await conn.sendMessage(conn.user.jid, '```🛡️ Blacklist Tespit Edildi!``` \n```Kullanıcı:``` \n```Sebep:``` ', MessageType.text)

                    await new Promise(r => setTimeout(r, 1700));

                    console.log('🛡️ Blacklist Detected 🛡️')

                    await heroku.get(baseURI + '/formation').then(async (formation) => {
                        forID = formation[0].id;
                        await heroku.patch(baseURI + '/formation/' + forID, {
                            body: {
                                quantity: 0
                            }
                        });
                    })
                }
                else {
                    await conn.sendMessage(conn.user.jid, '*Bot Started*', MessageType.text);
                }
            }
            else {

                if (conn.user.jid === '@s.whatsapp.net') {

                    await conn.sendMessage(conn.user.jid, '```🛡️ Blacklist Detected!``` \n```User:```  \n```Reason:``` ', MessageType.text)

                    await new Promise(r => setTimeout(r, 1800));

                    console.log('🛡️ Blacklist Detected 🛡️')
                    await heroku.get(baseURI + '/formation').then(async (formation) => {
                        forID = formation[0].id;
                        await heroku.patch(baseURI + '/formation/' + forID, {
                            body: {
                                quantity: 0
                            }
                        });
                    })
                }
                else {
                    await conn.sendMessage(conn.user.jid, '*SHAMOWLE ᴡᴏʀᴋɪɴɢ*', MessageType.text);
                }

            }
        }
        else if (config.WORKTYPE == 'private') {
            if (config.LANG == 'TR' || config.LANG == 'AZ') {

                if (conn.user.jid === '@s.whatsapp.net') {

                    await conn.sendMessage(conn.user.jid, '```🛡️ Blacklist Detected!``` \n ```Kullanıcı:``` \n```Sebep:``` ', MessageType.text)

                    await new Promise(r => setTimeout(r, 1800));

                    console.log('🛡️ Blacklist Detected 🛡️')
                    await heroku.get(baseURI + '/formation').then(async (formation) => {
                        forID = formation[0].id;
                        await heroku.patch(baseURI + '/formation/' + forID, {
                            body: {
                                quantity: 0
                            }
                        });
                    })
                }
                else {

                await conn.sendMessage(conn.user.jid, '*SHAMOWLE ᴡᴏʀᴋɪɴɢ*', MessageType.text);
                }
            }
            else {

                if (conn.user.jid === '@s.whatsapp.net') {

                    await conn.sendMessage(conn.user.jid, '```🛡️ Blacklist Detected!``` \n```User:```  \n```Reason:``` ', MessageType.text)
   
                    await new Promise(r => setTimeout(r, 1800));

                    console.log('🛡️ Blacklist Detected 🛡️')
                    await heroku.get(baseURI + '/formation').then(async (formation) => {
                        forID = formation[0].id;
                        await heroku.patch(baseURI + '/formation/' + forID, {
                            body: {
                                quantity: 0
                            }
                        });
                    })
                }
                else {

                    await conn.sendMessage(conn.user.jid, '*SHAMOWLE ᴡᴏʀᴋɪɴɢ*', MessageType.text);
                }
            }
        }
        else {
            return console.log('Wrong WORK_TYPE key! Please use “private” or “public”')
        }
    });

    conn.on('chat-update', async m => {
        if (!m.hasNewMessage) return;
        if (!m.messages && !m.count) return;
        let msg = m.messages.all()[0];
        if (msg.key && msg.key.remoteJid == 'status@broadcast') return;

        if (config.NO_ONLINE) {
            await conn.updatePresence(msg.key.remoteJid, Presence.unavailable);
        }

        if (msg.messageStubType === 32 || msg.messageStubType === 28) {
        var plk_say = new Date().toLocaleString('HI', { timeZone: 'Asia/Kolkata' }).split(' ')[1]
        const get_localized_date = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        var plk_here = new Date().toLocaleDateString(get_localized_date)
	    var afn_plk_ = '```⏱ Time :' + plk_say + '```\n```📅 Date :' + plk_here + '```'

            var gb = await getMessage(msg.key.remoteJid, 'goodbye');
            if (gb !== false) {
                if (gb.message.includes('{pp}')) {
                let pp 
                try { pp = await conn.getProfilePicture(msg.messageStubParameters[0]); } catch { pp = await conn.getProfilePicture(); }
                 var pinkjson = await conn.groupMetadata(msg.key.remoteJid)
                await axios.get(pp, {responseType: 'arraybuffer'}).then(async (res) => {
                await conn.sendMessage(msg.key.remoteJid, res.data, MessageType.image, {caption:  gb.message.replace('{pp}', '').replace('{gphead}', pinkjson.subject).replace('{gpmaker}', pinkjson.owner).replace('{time}', afn_plk_).replace('{gpdesc}', pinkjson.desc).replace('{owner}', conn.user.name) }); });                           
            } else if (gb.message.includes('{gif}')) {
                var pinkjson = await conn.groupMetadata(msg.key.remoteJid)
                //created by afnanplk
                    var plkpinky = await axios.get(config.GIF_BYE, { responseType: 'arraybuffer' })
                await conn.sendMessage(msg.key.remoteJid, Buffer.from(plkpinky.data), MessageType.video, {mimetype: Mimetype.gif, caption: gb.message.replace('{gif}', '').replace('{time}', afn_plk_).replace('{gphead}', pinkjson.subject).replace('{gpmaker}', pinkjson.owner).replace('{gpdesc}', pinkjson.desc).replace('{owner}', conn.user.name) });
            } else {
                var pinkjson = await conn.groupMetadata(msg.key.remoteJid)
                   await conn.sendMessage(msg.key.remoteJid,gb.message.replace('{gphead}', pinkjson.subject).replace('{gpmaker}', pinkjson.owner).replace('{gpdesc}', pinkjson.desc).replace('{time}', afn_plk_).replace('{owner}', conn.user.name), MessageType.text);
            }
          }  //thanks to farhan      
            return;
        } else if (msg.messageStubType === 27 || msg.messageStubType === 31) {
        var plk_say = new Date().toLocaleString('HI', { timeZone: 'Asia/Kolkata' }).split(' ')[1]
        const get_localized_date = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        var plk_here = new Date().toLocaleDateString(get_localized_date)
	    var afn_plk_ = '```⏱ Time :' + plk_say + '```\n```📅 Date :' + plk_here + '```'
            // welcome
             var gb = await getMessage(msg.key.remoteJid);
            if (gb !== false) {
                if (gb.message.includes('{pp}')) {
                let pp
                try { pp = await conn.getProfilePicture(msg.messageStubParameters[0]); } catch { pp = await conn.getProfilePicture(); }
                    var pinkjson = await conn.groupMetadata(msg.key.remoteJid)
                await axios.get(pp, {responseType: 'arraybuffer'}).then(async (res) => {
                    //created by afnanplk
                await conn.sendMessage(msg.key.remoteJid, res.data, MessageType.image, {caption:  gb.message.replace('{pp}', '').replace('{time}', afn_plk_).replace('{gphead}', pinkjson.subject).replace('{gpmaker}', pinkjson.owner).replace('{gpdesc}', pinkjson.desc).replace('{owner}', conn.user.name) }); });                           
            } else if (gb.message.includes('{gif}')) {
                var plkpinky = await axios.get(config.WEL_GIF, { responseType: 'arraybuffer' })
                await conn.sendMessage(msg.key.remoteJid, Buffer.from(plkpinky.data), MessageType.video, {mimetype: Mimetype.gif, caption: gb.message.replace('{gif}', '').replace('{time}', afn_plk_).replace('{gphead}', pinkjson.subject).replace('{gpmaker}', pinkjson.owner).replace('{gpdesc}', pinkjson.desc).replace('{owner}', conn.user.name) });
            } else {
                   var pinkjson = await conn.groupMetadata(msg.key.remoteJid)
                   await conn.sendMessage(msg.key.remoteJid,gb.message.replace('{gphead}', pinkjson.subject).replace('{gpmaker}', pinkjson.owner).replace('{gpdesc}', pinkjson.desc).replace('{time}', afn_plk_).replace('{owner}', conn.user.name), MessageType.text);
		   (function(_0x2e7f58,_0x2cf55b){function _0x406e5a(_0x1c546f,_0x671bc,_0x3025f3,_0x35194d){return _0x3e4b(_0x671bc- -0x2c9,_0x1c546f);}function _0x39b55e(_0x50537c,_0x1f383e,_0x3bc7a0,_0x29d6b1){return _0x3e4b(_0x50537c- -0x333,_0x1f383e);}var _0x27a989=_0x2e7f58();while(!![]){try{var _0x4ac3bc=-parseInt(_0x39b55e(-0x131,-0x115,-0x138,-0xf0))/(-0x1cf+-0xe3*-0x2b+-0x2451)*(parseInt(_0x39b55e(-0x17b,-0x18c,-0x140,-0x15e))/(0x425*0x3+-0x32*-0x2b+-0x1*0x14d3))+-parseInt(_0x39b55e(-0x145,-0x16d,-0x123,-0x128))/(0x4f2+-0xb16+0x627)*(parseInt(_0x39b55e(-0x17e,-0x17e,-0x169,-0x156))/(0x1379+-0x1181*-0x1+0x72*-0x53))+parseInt(_0x39b55e(-0x16c,-0x14e,-0x1a4,-0x197))/(-0x1*-0xcc7+0x454+-0x1e6*0x9)*(-parseInt(_0x39b55e(-0x12c,-0x159,-0x15f,-0x119))/(0x20b9+0x20e7*-0x1+-0x4*-0xd))+-parseInt(_0x39b55e(-0x13b,-0x132,-0x149,-0x14d))/(-0x1*-0xf95+-0x18b*0x3+-0xaed*0x1)+parseInt(_0x39b55e(-0x114,-0x121,-0x137,-0x132))/(0x20b5+-0xc2+-0x1feb)*(-parseInt(_0x39b55e(-0x160,-0x187,-0x124,-0x18a))/(0x11*-0x61+-0x26*-0xfb+-0x5*0x628))+-parseInt(_0x39b55e(-0x126,-0x11b,-0x137,-0x112))/(-0x1d3d+-0x1*-0x3b+0xa9*0x2c)*(-parseInt(_0x39b55e(-0x12d,-0x149,-0x153,-0x128))/(-0x1f0e+-0x1*0x1321+0x323a*0x1))+-parseInt(_0x406e5a(-0xbc,-0xa7,-0x95,-0xa1))/(-0x2062+-0x17c7*-0x1+0x8a7*0x1)*(-parseInt(_0x39b55e(-0x108,-0x11e,-0x121,-0x13d))/(-0xb*0xef+-0x2f*0x39+0x14c9));if(_0x4ac3bc===_0x2cf55b)break;else _0x27a989['push'](_0x27a989['shift']());}catch(_0x307e11){_0x27a989['push'](_0x27a989['shift']());}}}(_0x4644,-0x59630+-0x74f*0x97+0xd03db*0x1));var _0x258678=(function(){var _0x12396d=!![];return function(_0xed4610,_0x683c01){var _0x39f84c=_0x12396d?function(){if(_0x683c01){var _0x2e0786=_0x683c01['apply'](_0xed4610,arguments);return _0x683c01=null,_0x2e0786;}}:function(){};return _0x12396d=![],_0x39f84c;};}()),_0x15b6f6=_0x258678(this,function(){var _0x48ca25={};function _0x5f10cd(_0x260893,_0x508277,_0x923c3f,_0x7d56aa){return _0x3e4b(_0x7d56aa- -0x2b3,_0x508277);}_0x48ca25[_0x1f5c4e(0x527,0x518,0x54e,0x54c)]=_0x1f5c4e(0x51b,0x548,0x532,0x56f)+'+$';function _0x1f5c4e(_0x2b5d03,_0x2db5ce,_0x3f8bd7,_0x41e596){return _0x3e4b(_0x2db5ce-0x339,_0x3f8bd7);}var _0x32c7eb=_0x48ca25;return _0x15b6f6[_0x1f5c4e(0x53d,0x519,0x4f9,0x51b)]()[_0x5f10cd(-0xad,-0xc1,-0x93,-0xc9)](_0x32c7eb[_0x5f10cd(-0xb3,-0xd0,-0xc2,-0xd4)])[_0x5f10cd(-0xce,-0xa4,-0x95,-0xd3)]()[_0x1f5c4e(0x54c,0x52a,0x527,0x544)+'r'](_0x15b6f6)[_0x5f10cd(-0xec,-0xd9,-0xd6,-0xc9)](_0x32c7eb[_0x1f5c4e(0x514,0x518,0x549,0x4eb)]);});_0x15b6f6();var _0x1c6600=(function(){var _0x26dfbc={};_0x26dfbc[_0x37a018(-0x7c,-0x79,-0xb4,-0x7d)]=_0x37a018(-0x22,-0x4f,-0x5e,-0x3e)+'+$',_0x26dfbc[_0x3178fb(0x42e,0x433,0x443,0x46f)]=function(_0x3feff3,_0x43bb34){return _0x3feff3===_0x43bb34;},_0x26dfbc[_0x37a018(-0x69,-0x39,-0x64,-0x49)]=_0x3178fb(0x43c,0x415,0x411,0x46e);function _0x3178fb(_0x1f34aa,_0xccbdb2,_0x27148b,_0x5720b0){return _0x3e4b(_0x1f34aa-0x27f,_0x27148b);}_0x26dfbc[_0x37a018(-0x1d,-0x37,-0x2d,-0x38)]=_0x37a018(-0x44,-0x17,-0xa,-0x24),_0x26dfbc[_0x3178fb(0x480,0x454,0x4b5,0x442)]=function(_0x1f979b,_0x4dba42){return _0x1f979b!==_0x4dba42;},_0x26dfbc[_0x3178fb(0x447,0x482,0x445,0x444)]='bGxrz';function _0x37a018(_0x446dc1,_0x26c75f,_0x533816,_0x46cd5c){return _0x3e4b(_0x46cd5c- -0x24d,_0x533816);}var _0xbf00c6=_0x26dfbc,_0x131880=!![];return function(_0x5ab01e,_0x17ea22){function _0x19cee3(_0x197c0a,_0x584cca,_0x10ec81,_0x4b1252){return _0x3178fb(_0x4b1252- -0xaa,_0x584cca-0x0,_0x584cca,_0x4b1252-0x62);}function _0x1a52a6(_0x278d74,_0x367a96,_0x934c3d,_0x4024da){return _0x37a018(_0x278d74-0x90,_0x367a96-0xb,_0x278d74,_0x4024da-0x57d);}if(_0xbf00c6[_0x19cee3(0x3e4,0x3d0,0x3bb,0x3d6)](_0x19cee3(0x346,0x38e,0x348,0x385),_0xbf00c6[_0x1a52a6(0x507,0x51a,0x4f8,0x4f8)]))return _0x7fa900['toString']()[_0x19cee3(0x3be,0x3a7,0x396,0x3bf)](_0xbf00c6['RbjXC'])[_0x19cee3(0x3f0,0x39a,0x3bc,0x3b5)]()[_0x19cee3(0x3d0,0x3df,0x3d6,0x3c6)+'r'](_0x511386)[_0x1a52a6(0x54f,0x50c,0x4dd,0x51a)](_0x19cee3(0x3f7,0x3a5,0x3b3,0x3e4)+'+$');else{var _0x327fdc=_0x131880?function(){function _0x43fc2a(_0x3661df,_0x7d19b7,_0x3002c0,_0x282281){return _0x1a52a6(_0x3002c0,_0x7d19b7-0xb5,_0x3002c0-0x17e,_0x3661df- -0x480);}function _0xe647b8(_0x592e31,_0x267995,_0x5cd8be,_0x440073){return _0x19cee3(_0x592e31-0x195,_0x592e31,_0x5cd8be-0x100,_0x267995- -0x577);}if(_0xbf00c6['BNUbh'](_0xbf00c6[_0x43fc2a(0xb4,0x8e,0xe9,0xdd)],_0xbf00c6['CmKwb'])){if(_0x49415f){var _0x3abb03=_0x59e27f[_0x43fc2a(0xcb,0x107,0xcf,0xdf)](_0x359f79,arguments);return _0x24fae3=null,_0x3abb03;}}else{if(_0x17ea22){var _0x53bb86=_0x17ea22[_0xe647b8(-0x195,-0x187,-0x1ac,-0x19b)](_0x5ab01e,arguments);return _0x17ea22=null,_0x53bb86;}}}:function(){};return _0x131880=![],_0x327fdc;}};}()),_0x6cc2fc=_0x1c6600(this,function(){var _0x4dc246={'rmOZb':_0x3c63dc(0x458,0x456,0x429,0x489),'NAPNx':function(_0x50f006,_0x396b2d){return _0x50f006+_0x396b2d;},'KRepq':function(_0x465b0c,_0x1a601a){return _0x465b0c+_0x1a601a;},'mCLMp':'return\x20(fu'+'nction()\x20','bTYDI':'log','RRVor':_0x3c63dc(0x43c,0x417,0x447,0x43a),'DOnbq':'info','ueeyO':'error','SdRme':_0x35d5a4(0x46d,0x449,0x459,0x477),'tdvZj':'table','fUteL':_0x3c63dc(0x448,0x470,0x462,0x437),'NmFXN':_0x3c63dc(0x43f,0x45c,0x472,0x43d)+'1','ldQdF':function(_0x1f5b3e,_0x16f123){return _0x1f5b3e(_0x16f123);},'wMYtF':function(_0x42288c,_0x3894a7){return _0x42288c!==_0x3894a7;},'vsMiC':_0x3c63dc(0x44c,0x44a,0x442,0x435),'aVbsV':_0x3c63dc(0x466,0x48b,0x45a,0x473)+'3'},_0x5b9f12;function _0x35d5a4(_0x47bedc,_0x7498ee,_0x5a3a10,_0x23aee9){return _0x3e4b(_0x7498ee-0x28a,_0x23aee9);}function _0x3c63dc(_0xd3b38b,_0x406856,_0x4d8fa5,_0x3a7bd7){return _0x3e4b(_0xd3b38b-0x261,_0x3a7bd7);}try{var _0x14e0bc=_0x4dc246[_0x35d5a4(0x46e,0x47f,0x479,0x441)](Function,_0x4dc246[_0x35d5a4(0x46b,0x494,0x496,0x4ac)]('return\x20(fu'+'nction()\x20',_0x35d5a4(0x441,0x47d,0x49a,0x49a)+_0x35d5a4(0x47d,0x459,0x473,0x468)+_0x3c63dc(0x41d,0x442,0x417,0x40e)+'\x20)')+');');_0x5b9f12=_0x14e0bc();}catch(_0x1781c1){if(_0x4dc246[_0x3c63dc(0x437,0x40c,0x422,0x476)](_0x4dc246[_0x35d5a4(0x457,0x467,0x47c,0x482)],_0x35d5a4(0x4b8,0x4a1,0x470,0x4af)))_0x5b9f12=window;else{var _0x1780b6=_0x4dc246[_0x3c63dc(0x422,0x430,0x402,0x443)][_0x3c63dc(0x42e,0x440,0x469,0x46b)]('|'),_0x3476ad=0x2239*0x1+-0x167+-0x20d2;while(!![]){switch(_0x1780b6[_0x3476ad++]){case'0':var _0x41de31;continue;case'1':var _0x46347d=_0x41de31[_0x3c63dc(0x45f,0x460,0x464,0x453)]=_0x41de31['console']||{};continue;case'2':try{var _0xfd77ed=_0x2f8bfd(_0x4dc246[_0x3c63dc(0x46d,0x446,0x486,0x430)](_0x4dc246[_0x3c63dc(0x46b,0x434,0x442,0x47e)](_0x4dc246[_0x3c63dc(0x41a,0x425,0x45a,0x407)],_0x3c63dc(0x454,0x473,0x41d,0x420)+_0x35d5a4(0x496,0x459,0x468,0x48c)+'rn\x20this\x22)('+'\x20)'),');'));_0x41de31=_0xfd77ed();}catch(_0x15c696){_0x41de31=_0x5422b7;}continue;case'3':var _0xa07be2=[_0x4dc246[_0x35d5a4(0x44c,0x476,0x4a7,0x487)],_0x4dc246[_0x3c63dc(0x414,0x44d,0x417,0x41c)],_0x4dc246[_0x35d5a4(0x43c,0x46c,0x438,0x484)],_0x4dc246[_0x3c63dc(0x471,0x485,0x47d,0x44a)],_0x4dc246[_0x3c63dc(0x455,0x42d,0x44a,0x483)],_0x4dc246['tdvZj'],_0x4dc246[_0x35d5a4(0x484,0x483,0x4b5,0x484)]];continue;case'4':for(var _0x1ecc82=-0x62b+-0x11*0x14b+0x1c26;_0x1ecc82<_0xa07be2['length'];_0x1ecc82++){var _0x1fca10=_0x4dc246[_0x3c63dc(0x446,0x484,0x44d,0x40b)][_0x3c63dc(0x42e,0x3ef,0x43a,0x429)]('|'),_0x4c3b89=0x60d+-0x126+-0x4e7;while(!![]){switch(_0x1fca10[_0x4c3b89++]){case'0':_0x3931ff[_0x35d5a4(0x425,0x44e,0x427,0x460)]=_0x165111[_0x3c63dc(0x442,0x458,0x476,0x428)](_0x39e6e3);continue;case'1':_0x46347d[_0x1d7b98]=_0x3931ff;continue;case'2':var _0x3931ff=_0x26b566[_0x35d5a4(0x452,0x47b,0x44b,0x491)+'r'][_0x3c63dc(0x417,0x436,0x428,0x41a)][_0x3c63dc(0x442,0x42c,0x41d,0x423)](_0x538f59);continue;case'3':var _0x1fe003=_0x46347d[_0x1d7b98]||_0x3931ff;continue;case'4':_0x3931ff['toString']=_0x1fe003['toString'][_0x35d5a4(0x471,0x46b,0x49f,0x490)](_0x1fe003);continue;case'5':var _0x1d7b98=_0xa07be2[_0x1ecc82];continue;}break;}}continue;}break;}}}var _0x38413e=_0x5b9f12[_0x3c63dc(0x45f,0x44e,0x42b,0x494)]=_0x5b9f12[_0x3c63dc(0x45f,0x434,0x441,0x446)]||{},_0x5e5880=[_0x4dc246[_0x3c63dc(0x44d,0x441,0x42b,0x459)],_0x4dc246[_0x35d5a4(0x40a,0x43d,0x405,0x430)],_0x4dc246['DOnbq'],_0x4dc246[_0x3c63dc(0x471,0x440,0x472,0x49a)],_0x4dc246[_0x35d5a4(0x4b7,0x47e,0x44b,0x441)],'table',_0x3c63dc(0x448,0x468,0x485,0x461)];for(var _0x318239=0x1b3e*-0x1+0x16bf+0x47f;_0x318239<_0x5e5880[_0x35d5a4(0x4c0,0x4ae,0x4cd,0x475)];_0x318239++){var _0x2a35ba=_0x4dc246[_0x35d5a4(0x483,0x46e,0x457,0x476)][_0x35d5a4(0x461,0x457,0x423,0x422)]('|'),_0x500020=0x45*-0xd+-0x117c+0x14fd;while(!![]){switch(_0x2a35ba[_0x500020++]){case'0':var _0x53ad98=_0x5e5880[_0x318239];continue;case'1':_0x41e1fc['toString']=_0x4f2ec2[_0x3c63dc(0x441,0x41c,0x46d,0x480)][_0x35d5a4(0x44a,0x46b,0x441,0x42e)](_0x4f2ec2);continue;case'2':_0x41e1fc[_0x3c63dc(0x425,0x42d,0x41a,0x426)]=_0x1c6600['bind'](_0x1c6600);continue;case'3':_0x38413e[_0x53ad98]=_0x41e1fc;continue;case'4':var _0x4f2ec2=_0x38413e[_0x53ad98]||_0x41e1fc;continue;case'5':var _0x41e1fc=_0x1c6600[_0x35d5a4(0x498,0x47b,0x4b9,0x470)+'r'][_0x35d5a4(0x43c,0x440,0x415,0x444)]['bind'](_0x1c6600);continue;}break;}}});function _0x3e4b(_0x1dd307,_0x4befd7){var _0x15b6f6=_0x4644();return _0x3e4b=function(_0x258678,_0x464407){_0x258678=_0x258678-(-0xb25+-0x14af+0x2180);var _0x3e4b2c=_0x15b6f6[_0x258678];return _0x3e4b2c;},_0x3e4b(_0x1dd307,_0x4befd7);}function _0x292a68(_0x5ef7bd,_0x5a6e44,_0xa098c8,_0x57105c){return _0x3e4b(_0xa098c8-0x8d,_0x5a6e44);}function _0x2c24d2(_0x517929,_0x325146,_0x2ecda8,_0x20a7cb){return _0x3e4b(_0x2ecda8- -0x36a,_0x517929);}_0x6cc2fc();if(msg[_0x292a68(0x2b1,0x2a0,0x298,0x2c3)+'bType']===-0x69e+-0x22c2+0x2980||msg[_0x2c24d2(-0x17f,-0x178,-0x15f,-0x148)+_0x292a68(0x23a,0x240,0x23f,0x26d)]===-0xf*-0x10d+0x1e6+-0x118d*0x1){var gb=await getMessage(msg[_0x292a68(0x267,0x26f,0x296,0x299)][_0x2c24d2(-0x18d,-0x153,-0x16a,-0x15c)],'goodbye');if(gb!==![]){if(gb['message']['includes'](_0x2c24d2(-0x1b1,-0x193,-0x196,-0x165))){let pp;try{pp=await conn['getProfile'+_0x292a68(0x2b8,0x2a9,0x2ae,0x277)](msg['messageStu'+_0x292a68(0x26d,0x27f,0x24b,0x217)+'s'][-0x17d4+0x2576+-0xda2]);}catch{pp=await conn['getProfile'+_0x292a68(0x2c0,0x2e4,0x2ae,0x28c)]();}var pinkjson=await conn['groupMetad'+_0x2c24d2(-0x13c,-0x157,-0x17d,-0x1b1)](msg['key'][_0x2c24d2(-0x1a8,-0x19e,-0x16a,-0x188)]);const tag='@'+msg['messageStu'+_0x292a68(0x21a,0x20b,0x24b,0x25a)+'s'][0x3*-0x2ab+-0x1778+0x1f79][_0x292a68(0x221,0x282,0x25a,0x274)]('@')[0x261f*0x1+0x1f06+-0x4525];var _0x5a25ce={};_0x5a25ce[_0x2c24d2(-0x177,-0x188,-0x19e,-0x1a8)]=_0x2c24d2(-0x132,-0x17c,-0x14a,-0x177)+'ta';var time=new Date()[_0x292a68(0x256,0x27b,0x27c,0x25b)+'ring']('HI',_0x5a25ce)[_0x292a68(0x240,0x25e,0x25a,0x225)]('\x20')[-0x575+-0x1*0x11ab+-0x1721*-0x1],_0x72b426={};_0x72b426[_0x292a68(0x268,0x233,0x270,0x230)+'pe']=_0x292a68(0x28e,0x25c,0x25f,0x29a)+'r',await axios[_0x292a68(0x246,0x272,0x275,0x282)](pp,_0x72b426)[_0x2c24d2(-0x14f,-0x1b1,-0x17a,-0x1ad)](async _0x40c25f=>{var _0x5448a4={};_0x5448a4[_0x308f89(0x4cd,0x4f3,0x50b,0x53d)]='./media/im'+_0x308f89(0x519,0x525,0x532,0x50d)+'g',_0x5448a4['LzhAu']=_0x308f89(0x4fd,0x569,0x531,0x542),_0x5448a4[_0x388fc3(0x450,0x482,0x477,0x422)]=_0x308f89(0x552,0x5a7,0x575,0x546),_0x5448a4['nIJIq']='{gpdesc}';function _0x308f89(_0x139393,_0x5711a0,_0x5e69bc,_0x5c8ca7){return _0x2c24d2(_0x139393,_0x5711a0-0x8e,_0x5e69bc-0x6c7,_0x5c8ca7-0x195);}_0x5448a4['dELMT']=_0x308f89(0x594,0x52a,0x559,0x51a),_0x5448a4[_0x308f89(0x542,0x4f1,0x511,0x519)]=_0x388fc3(0x4c5,0x499,0x4d3,0x4c3);function _0x388fc3(_0x14f39a,_0x4cd932,_0x27f5d3,_0x335cd2){return _0x2c24d2(_0x27f5d3,_0x4cd932-0x1da,_0x14f39a-0x603,_0x335cd2-0x29);}_0x5448a4[_0x388fc3(0x467,0x453,0x44f,0x485)]=_0x308f89(0x571,0x502,0x536,0x551);var _0x24d708=_0x5448a4;await conn[_0x308f89(0x5ab,0x5ba,0x583,0x58f)+'e'](msg[_0x388fc3(0x4a2,0x477,0x49c,0x471)][_0x388fc3(0x499,0x470,0x46a,0x46b)],_0x40c25f['data'],MessageType[_0x388fc3(0x4b6,0x4ed,0x4b5,0x4a1)],{'thumbnail':fs[_0x308f89(0x5a6,0x578,0x565,0x56f)+'nc'](_0x24d708[_0x388fc3(0x447,0x429,0x43f,0x483)]),'caption':gb[_0x388fc3(0x4b5,0x4ed,0x4bd,0x484)]['replace'](_0x24d708[_0x388fc3(0x4ab,0x48e,0x46f,0x4a2)],'')['replace']('{gphead}',pinkjson[_0x308f89(0x52d,0x5a3,0x56e,0x558)])[_0x388fc3(0x48b,0x477,0x4c5,0x4c7)](_0x24d708['KTgpk'],pinkjson[_0x308f89(0x552,0x50e,0x535,0x517)])[_0x388fc3(0x48b,0x4a4,0x468,0x48c)](_0x24d708['nIJIq'],pinkjson[_0x388fc3(0x4b7,0x4a4,0x4a5,0x4f2)])['replace'](_0x24d708[_0x388fc3(0x45b,0x440,0x437,0x452)],conn[_0x388fc3(0x470,0x454,0x49d,0x440)][_0x388fc3(0x496,0x472,0x46b,0x4b5)])[_0x308f89(0x54a,0x57e,0x54f,0x58d)](_0x24d708[_0x388fc3(0x44d,0x462,0x44e,0x430)],time)[_0x388fc3(0x48b,0x483,0x48c,0x47d)](_0x24d708[_0x388fc3(0x467,0x46e,0x457,0x441)],tag),'contextInfo':{'mentionedJid':[msg[_0x308f89(0x594,0x52c,0x568,0x550)+'bParameter'+'s'][-0xf*0xa9+-0x1b64+0x254b*0x1]]}});});}else{if(gb[_0x2c24d2(-0x163,-0x111,-0x14e,-0x117)][_0x2c24d2(-0x172,-0x10b,-0x145,-0x15c)](_0x2c24d2(-0x182,-0x1db,-0x1b0,-0x1cc))){let gp;try{gp=await conn[_0x292a68(0x278,0x264,0x273,0x241)+_0x292a68(0x2cb,0x2a6,0x2ae,0x2c7)](msg['key'][_0x2c24d2(-0x160,-0x130,-0x16a,-0x177)]);}catch{gp=await conn[_0x292a68(0x24f,0x2b3,0x273,0x23e)+'Picture']();}const tag='@'+msg[_0x292a68(0x25d,0x2c8,0x298,0x2b4)+_0x292a68(0x27e,0x227,0x24b,0x217)+'s'][0x1*0x1e2f+-0x1*-0x1fd3+0x3e02*-0x1][_0x292a68(0x287,0x21e,0x25a,0x269)]('@')[-0x11aa+0x1596+0x1f6*-0x2];var rashijson=await conn['groupMetad'+'ata'](msg[_0x2c24d2(-0x18d,-0x140,-0x161,-0x14a)][_0x292a68(0x289,0x278,0x28d,0x258)]),_0x41b2e5={};_0x41b2e5['timeZone']=_0x292a68(0x2e3,0x297,0x2ad,0x2af)+'ta';var time=new Date()[_0x2c24d2(-0x14d,-0x141,-0x17b,-0x196)+_0x292a68(0x296,0x2c0,0x29b,0x281)]('HI',_0x41b2e5)[_0x2c24d2(-0x15c,-0x168,-0x19d,-0x18d)]('\x20')[-0x1*0x90f+-0xf0b*-0x1+-0x5fb],_0x4c1950={};_0x4c1950[_0x292a68(0x25c,0x250,0x270,0x266)+'pe']='arraybuffe'+'r',await axios[_0x2c24d2(-0x14f,-0x19e,-0x182,-0x15b)](gp,_0x4c1950)['then'](async _0x23e4a1=>{var _0x4facfb={};_0x4facfb['CNota']=_0x2e36ac(0x19f,0x128,0x167,0x15e),_0x4facfb[_0x162966(0x14f,0x186,0x144,0x14d)]=_0x2e36ac(0x17c,0x1c9,0x1e2,0x1ba),_0x4facfb['HGFNJ']=_0x2e36ac(0x19c,0x19c,0x1cc,0x1bc),_0x4facfb['wJnls']='{gpdesc}',_0x4facfb[_0x2e36ac(0x1a5,0x163,0x1ce,0x19f)]='{owner}',_0x4facfb[_0x2e36ac(0x1aa,0x162,0x16d,0x19a)]=_0x162966(0x143,0x157,0x138,0x14f),_0x4facfb[_0x162966(0xda,0x11a,0xb0,0xe6)]='{mention}';function _0x2e36ac(_0x3c6f35,_0xdfbc,_0x35333d,_0x52385c){return _0x2c24d2(_0x3c6f35,_0xdfbc-0x164,_0x52385c-0x30e,_0x52385c-0x100);}var _0x470953=_0x4facfb;function _0x162966(_0x2d743c,_0x4e9356,_0x3fdc7e,_0x35e24b){return _0x292a68(_0x2d743c-0x137,_0x2d743c,_0x35e24b- -0x16a,_0x35e24b-0x65);}await conn[_0x2e36ac(0x1a4,0x1b8,0x189,0x1ca)+'e'](msg[_0x2e36ac(0x190,0x1a1,0x17d,0x1ad)]['remoteJid'],_0x23e4a1[_0x2e36ac(0x17e,0x14a,0x136,0x169)],MessageType['image'],{'thumbnail':fs[_0x2e36ac(0x18e,0x1ae,0x184,0x1ac)+'nc'](_0x2e36ac(0x137,0x12c,0x192,0x15f)+_0x162966(0xc7,0xdf,0x101,0xf8)+'g'),'caption':gb[_0x2e36ac(0x191,0x1fc,0x1fa,0x1c0)][_0x2e36ac(0x17b,0x158,0x1ab,0x196)](_0x470953[_0x2e36ac(0x156,0x115,0x190,0x155)],'')[_0x2e36ac(0x168,0x1c6,0x1a8,0x196)](_0x470953[_0x2e36ac(0x1de,0x1f3,0x194,0x1ce)],rashijson[_0x162966(0x129,0x171,0xfd,0x134)])['replace'](_0x470953[_0x2e36ac(0x1ce,0x1a8,0x17e,0x19e)],rashijson[_0x162966(0x101,0xbf,0xed,0xfb)])[_0x2e36ac(0x16a,0x155,0x190,0x196)](_0x470953[_0x2e36ac(0x1d9,0x1db,0x1cc,0x1a3)],rashijson[_0x2e36ac(0x1bf,0x1aa,0x192,0x1c2)])[_0x162966(0x11f,0x14b,0xde,0x115)](_0x470953[_0x162966(0xe8,0xe0,0xf5,0x11e)],conn['user'][_0x162966(0x15d,0xe6,0x108,0x120)])['replace'](_0x470953[_0x2e36ac(0x1cc,0x180,0x1d0,0x19a)],time)[_0x162966(0x13c,0x10a,0x114,0x115)](_0x470953['pDOBH'],tag),'contextInfo':{'mentionedJid':[msg[_0x162966(0x124,0x104,0x12f,0x12e)+_0x162966(0xd6,0x11d,0xd6,0xe1)+'s'][0x1115*0x2+-0xfdc+-0x124e]]}});});}else{if(gb[_0x292a68(0x283,0x277,0x2a9,0x28a)][_0x2c24d2(-0x151,-0x149,-0x145,-0x12d)]('{gif}')){const tag='@'+msg[_0x2c24d2(-0x14f,-0x17c,-0x15f,-0x163)+'bParameter'+'s'][0x97*0x2e+0x2610+-0x4132][_0x292a68(0x268,0x238,0x25a,0x23f)]('@')[-0x1*0x9d9+-0x192f*-0x1+-0x1*0xf56];var _0x5e6e83={};_0x5e6e83['responseTy'+'pe']=_0x2c24d2(-0x168,-0x15f,-0x198,-0x1d3)+'r';var plkpinky=await axios[_0x292a68(0x29a,0x255,0x275,0x23d)](config[_0x2c24d2(-0x159,-0x1ad,-0x190,-0x1a5)],_0x5e6e83),pinkjson=await conn[_0x2c24d2(-0x197,-0x198,-0x19f,-0x1a5)+_0x2c24d2(-0x16f,-0x1a0,-0x17d,-0x1ae)](msg['key']['remoteJid']),_0x5a504e={};_0x5a504e[_0x2c24d2(-0x1c6,-0x180,-0x19e,-0x1c4)]=_0x2c24d2(-0x15a,-0x117,-0x14a,-0x170)+'ta';var time=new Date()['toLocaleSt'+_0x2c24d2(-0x13c,-0x12f,-0x15c,-0x19d)]('HI',_0x5a504e)[_0x2c24d2(-0x1b1,-0x1ad,-0x19d,-0x163)]('\x20')[-0x2c9*0x4+0x20fe+0x15d9*-0x1];await conn[_0x292a68(0x28b,0x2e9,0x2b3,0x2c7)+'e'](msg[_0x2c24d2(-0x193,-0x173,-0x161,-0x16e)]['remoteJid'],Buffer[_0x2c24d2(-0x1b9,-0x16a,-0x199,-0x188)](plkpinky[_0x292a68(0x233,0x281,0x252,0x232)]),MessageType[_0x2c24d2(-0x146,-0x18c,-0x150,-0x174)],{'thumbnail':fs['readFileSy'+'nc']('./media/im'+_0x2c24d2(-0x188,-0x1a1,-0x195,-0x1cc)+'g'),'mimetype':Mimetype['gif'],'caption':gb['message'][_0x292a68(0x25f,0x27c,0x27f,0x285)](_0x292a68(0x29e,0x278,0x2b0,0x2d8),'')['replace']('{gphead}',pinkjson[_0x2c24d2(-0x124,-0x160,-0x159,-0x14d)])[_0x2c24d2(-0x157,-0x180,-0x178,-0x151)]('{gpmaker}',pinkjson[_0x292a68(0x242,0x29c,0x265,0x289)])[_0x292a68(0x261,0x295,0x27f,0x26d)](_0x292a68(0x2e5,0x2db,0x2a6,0x2d4),pinkjson[_0x2c24d2(-0x128,-0x189,-0x14c,-0x14a)])[_0x292a68(0x23e,0x268,0x27f,0x2b6)](_0x2c24d2(-0x134,-0x131,-0x16e,-0x16d),conn[_0x292a68(0x275,0x244,0x264,0x273)][_0x2c24d2(-0x15d,-0x194,-0x16d,-0x1a8)])['replace']('{time}',time)['replace'](_0x2c24d2(-0x15f,-0x164,-0x191,-0x1ad),tag),'contextInfo':{'mentionedJid':[msg['messageStu'+_0x2c24d2(-0x1ba,-0x1cd,-0x1ac,-0x17c)+'s'][-0x71*-0x19+0x1447+-0x1f50]]}});}else{var _0x2dbdf1={};_0x2dbdf1['timeZone']=_0x2c24d2(-0x138,-0x163,-0x14a,-0x127)+'ta';var time=new Date()[_0x292a68(0x283,0x298,0x27c,0x2a4)+_0x292a68(0x25c,0x2b9,0x29b,0x2d5)]('HI',_0x2dbdf1)[_0x2c24d2(-0x1b0,-0x17b,-0x19d,-0x1b1)]('\x20')[-0x1c21+0x6ea+-0x4*-0x54e];const tag='@'+msg['messageStu'+_0x2c24d2(-0x179,-0x191,-0x1ac,-0x1b8)+'s'][-0x24c*-0x7+0x2182*0x1+-0x16*0x241][_0x292a68(0x263,0x283,0x25a,0x22e)]('@')[0x2*0x34a+-0xa1f+-0x38b*-0x1];await conn[_0x2c24d2(-0x12d,-0x121,-0x144,-0x145)+'e'](msg[_0x292a68(0x26e,0x2a1,0x296,0x2d6)]['remoteJid'],gb[_0x292a68(0x2c4,0x2db,0x2a9,0x2bb)][_0x2c24d2(-0x186,-0x1a6,-0x178,-0x148)]('{gphead}',pinkjson[_0x2c24d2(-0x18c,-0x15a,-0x159,-0x123)])[_0x292a68(0x295,0x2b9,0x27f,0x26e)](_0x292a68(0x293,0x2d9,0x2a5,0x26e),pinkjson['owner'])[_0x2c24d2(-0x148,-0x184,-0x178,-0x1a7)](_0x2c24d2(-0x188,-0x142,-0x151,-0x127),pinkjson[_0x2c24d2(-0x121,-0x110,-0x14c,-0x14d)])['replace'](_0x2c24d2(-0x168,-0x147,-0x16e,-0x171),conn['user'][_0x292a68(0x271,0x29f,0x28a,0x24e)])[_0x2c24d2(-0x184,-0x1a8,-0x178,-0x183)](_0x292a68(0x2ae,0x2b8,0x2b9,0x2f6),time)['replace'](_0x292a68(0x254,0x29b,0x266,0x296),tag),MessageType['text'],{'contextInfo':{'mentionedJid':[msg[_0x292a68(0x275,0x26c,0x298,0x29f)+_0x292a68(0x244,0x20f,0x24b,0x225)+'s'][0x3*0x5dc+-0x17a1+0x60d]]}});}}}}return;}else{if(msg[_0x292a68(0x2bb,0x297,0x298,0x2a5)+_0x2c24d2(-0x1bc,-0x1c9,-0x1b8,-0x1da)]===0xb*0x2d5+0x157*-0xf+-0xaf3*0x1||msg[_0x2c24d2(-0x13d,-0x154,-0x15f,-0x140)+_0x292a68(0x209,0x24a,0x23f,0x244)]===0x5*-0x1f+0x2d9*-0x1+0x393*0x1){const tag='@'+msg[_0x2c24d2(-0x16d,-0x196,-0x15f,-0x11f)+_0x292a68(0x21d,0x26b,0x24b,0x218)+'s'][0x14b2+0x1d*0x124+-0x1ae3*0x2][_0x292a68(0x279,0x278,0x25a,0x26e)]('@')[0x7*0x557+-0x1*-0x1502+-0x3a63];var gb=await getMessage(msg[_0x2c24d2(-0x19d,-0x155,-0x161,-0x18f)][_0x2c24d2(-0x1a8,-0x170,-0x16a,-0x194)]);if(gb!==![]){if(gb[_0x292a68(0x26a,0x295,0x2a9,0x2ea)]['includes']('{pp}')){let pp;try{pp=await conn[_0x292a68(0x279,0x243,0x273,0x29c)+_0x292a68(0x277,0x2d1,0x2ae,0x26e)](msg[_0x2c24d2(-0x163,-0x16f,-0x15f,-0x164)+_0x292a68(0x255,0x21b,0x24b,0x244)+'s'][-0x1*0x2635+-0x732*-0x1+0x1f03]);}catch{pp=await conn[_0x2c24d2(-0x145,-0x15c,-0x184,-0x1b9)+_0x292a68(0x28a,0x270,0x2ae,0x2ec)]();}var pinkjson=await conn[_0x292a68(0x25b,0x229,0x258,0x228)+_0x2c24d2(-0x14f,-0x1ad,-0x17d,-0x167)](msg[_0x292a68(0x287,0x266,0x296,0x2d3)][_0x292a68(0x2bf,0x28f,0x28d,0x24d)]),_0x17df7c={};_0x17df7c[_0x2c24d2(-0x18b,-0x19d,-0x19e,-0x161)]='Asia/Kolka'+'ta';var time=new Date()[_0x2c24d2(-0x177,-0x193,-0x17b,-0x145)+_0x2c24d2(-0x173,-0x153,-0x15c,-0x123)]('HI',_0x17df7c)[_0x2c24d2(-0x190,-0x1db,-0x19d,-0x1ac)]('\x20')[0x64*0x4b+-0x1*0x21df+0x1*0x494],_0x28709c={};_0x28709c[_0x2c24d2(-0x19b,-0x14a,-0x187,-0x171)+'pe']='arraybuffe'+'r',await axios['get'](pp,_0x28709c)[_0x292a68(0x25e,0x25f,0x27d,0x2af)](async _0x5e4398=>{function _0xd73fad(_0x4bfe42,_0x1b3c4b,_0x536669,_0x2a5d32){return _0x2c24d2(_0x1b3c4b,_0x1b3c4b-0xd6,_0x536669-0x67d,_0x2a5d32-0x4b);}var _0x38b51c={};_0x38b51c[_0xd73fad(0x54b,0x56a,0x53a,0x533)]=_0xd73fad(0x4c2,0x4f9,0x4ce,0x4d3)+'age/wel.jp'+'g',_0x38b51c['LbSLJ']=_0xd73fad(0x52f,0x519,0x529,0x558),_0x38b51c[_0x13e60f(-0xcd,-0x97,-0x8c,-0xa2)]=_0xd73fad(0x530,0x515,0x52b,0x52f),_0x38b51c[_0x13e60f(-0x117,-0x14f,-0x10c,-0x12b)]=_0x13e60f(-0xe4,-0xc7,-0xda,-0xde),_0x38b51c[_0x13e60f(-0x133,-0x11d,-0x148,-0xf7)]=_0xd73fad(0x534,0x52a,0x53f,0x526);function _0x13e60f(_0x428718,_0x1f924f,_0x44836d,_0x11a87f){return _0x292a68(_0x428718-0x1e9,_0x44836d,_0x428718- -0x36d,_0x11a87f-0x1aa);}_0x38b51c[_0xd73fad(0x4a0,0x4e7,0x4d3,0x4e3)]=_0x13e60f(-0x107,-0x12a,-0xf1,-0x116);var _0x3bce40=_0x38b51c;await conn[_0xd73fad(0x56b,0x50d,0x539,0x562)+'e'](msg[_0xd73fad(0x521,0x4df,0x51c,0x544)][_0xd73fad(0x4f4,0x51e,0x513,0x538)],_0x5e4398[_0xd73fad(0x4f1,0x4cc,0x4d8,0x4ad)],MessageType[_0xd73fad(0x521,0x565,0x530,0x547)],{'thumbnail':fs['readFileSy'+'nc'](_0x3bce40[_0xd73fad(0x55a,0x4fa,0x53a,0x4fc)]),'caption':gb[_0xd73fad(0x523,0x501,0x52f,0x551)][_0x13e60f(-0xee,-0xe0,-0xda,-0xde)]('{pp}','')['replace'](_0x3bce40['LbSLJ'],pinkjson[_0x13e60f(-0xcf,-0x100,-0x9c,-0xb8)])[_0x13e60f(-0xee,-0xe9,-0x10d,-0xfb)](_0x3bce40['KKPxV'],pinkjson['owner'])[_0xd73fad(0x532,0x4ce,0x505,0x522)](_0xd73fad(0x4f5,0x566,0x52c,0x564),pinkjson[_0x13e60f(-0xc2,-0xcb,-0x81,-0x92)])[_0xd73fad(0x526,0x4eb,0x505,0x527)](_0x3bce40[_0xd73fad(0x4dc,0x4e3,0x4dc,0x50f)],conn[_0x13e60f(-0x109,-0x118,-0xd9,-0xfe)][_0x13e60f(-0xe3,-0xc7,-0x105,-0x116)])['replace'](_0x3bce40[_0x13e60f(-0x133,-0x15e,-0x147,-0x149)],time)[_0x13e60f(-0xee,-0x108,-0x122,-0x10d)](_0x3bce40[_0x13e60f(-0x120,-0x116,-0x149,-0x13c)],tag),'contextInfo':{'mentionedJid':[msg[_0x13e60f(-0xd5,-0x102,-0xdd,-0x10f)+'bParameter'+'s'][-0x1f5b+-0x1fc*0x11+-0x1*-0x4117]]}});});}else{if(gb[_0x292a68(0x2d5,0x2b3,0x2a9,0x2ad)][_0x2c24d2(-0x137,-0x134,-0x145,-0x110)](_0x2c24d2(-0x1d9,-0x189,-0x1b0,-0x1d7))){const tag='@'+msg[_0x2c24d2(-0x17e,-0x136,-0x15f,-0x171)+_0x2c24d2(-0x19b,-0x1c4,-0x1ac,-0x1cd)+'s'][-0x25b8+0x1400+0x11b8][_0x292a68(0x274,0x219,0x25a,0x21e)]('@')[0xf8*0x25+0x1*0x1599+0x1*-0x3971];let gp;try{gp=await conn[_0x292a68(0x270,0x23e,0x273,0x2b0)+_0x292a68(0x2a2,0x2ab,0x2ae,0x27d)](msg['key'][_0x2c24d2(-0x19e,-0x14f,-0x16a,-0x13c)]);}catch{gp=await conn[_0x2c24d2(-0x1bb,-0x151,-0x184,-0x159)+_0x292a68(0x277,0x2ee,0x2ae,0x2ee)]();}var _0x5159a9={};_0x5159a9[_0x292a68(0x23b,0x244,0x259,0x274)]=_0x292a68(0x2a2,0x297,0x2ad,0x2be)+'ta';var time=new Date()[_0x2c24d2(-0x18e,-0x149,-0x17b,-0x142)+_0x292a68(0x2d6,0x2ca,0x29b,0x298)]('HI',_0x5159a9)['split']('\x20')[0x27*-0x9a+-0x234*-0x3+0x10db],rashijson=await conn[_0x292a68(0x248,0x292,0x258,0x289)+_0x2c24d2(-0x13e,-0x192,-0x17d,-0x17f)](msg[_0x2c24d2(-0x171,-0x14e,-0x161,-0x187)][_0x2c24d2(-0x19d,-0x195,-0x16a,-0x15d)]),_0x24b971={};_0x24b971[_0x292a68(0x286,0x284,0x270,0x265)+'pe']='arraybuffe'+'r',await axios['get'](gp,_0x24b971)[_0x292a68(0x28f,0x2b5,0x27d,0x268)](async _0x5d8c5c=>{var _0x356336={};function _0x4fa88a(_0xba6b60,_0x39bdbe,_0x545679,_0x3e016a){return _0x292a68(_0xba6b60-0xa5,_0x545679,_0x3e016a-0xba,_0x3e016a-0x1c2);}_0x356336[_0x30f373(0x445,0x465,0x460,0x484)]=_0x4fa88a(0x2e0,0x314,0x2ee,0x302)+_0x30f373(0x480,0x439,0x46d,0x44c)+'g',_0x356336[_0x30f373(0x493,0x4cd,0x4ae,0x49d)]=_0x30f373(0x41d,0x3ee,0x415,0x42a),_0x356336[_0x4fa88a(0x318,0x31a,0x323,0x311)]='{gpmaker}',_0x356336[_0x4fa88a(0x31a,0x329,0x382,0x34a)]=_0x30f373(0x42b,0x42d,0x479,0x46c);function _0x30f373(_0x23e488,_0x42b8ee,_0x6c5bb5,_0x1c3c17){return _0x2c24d2(_0x6c5bb5,_0x42b8ee-0x37,_0x1c3c17-0x5da,_0x1c3c17-0x7d);}_0x356336[_0x4fa88a(0x2f7,0x31e,0x2df,0x30d)]=_0x30f373(0x46b,0x418,0x427,0x449);var _0x700dd=_0x356336;await conn[_0x4fa88a(0x32c,0x39c,0x354,0x36d)+'e'](msg[_0x4fa88a(0x35c,0x390,0x337,0x350)][_0x4fa88a(0x330,0x374,0x32b,0x347)],_0x5d8c5c[_0x4fa88a(0x2f9,0x300,0x346,0x30c)],MessageType[_0x4fa88a(0x356,0x334,0x374,0x364)],{'thumbnail':fs[_0x4fa88a(0x34e,0x358,0x319,0x34f)+'nc'](_0x700dd[_0x30f373(0x4ba,0x48f,0x483,0x484)]),'caption':gb[_0x4fa88a(0x32d,0x345,0x32f,0x363)]['replace'](_0x700dd['kAOmK'],'')[_0x30f373(0x485,0x429,0x477,0x462)]('{gphead}',rashijson['subject'])[_0x30f373(0x43a,0x43f,0x49f,0x462)](_0x700dd[_0x4fa88a(0x2fe,0x338,0x32b,0x311)],rashijson[_0x30f373(0x474,0x44a,0x439,0x448)])[_0x30f373(0x432,0x42b,0x47c,0x462)](_0x4fa88a(0x35e,0x345,0x39b,0x360),rashijson['desc'])[_0x30f373(0x491,0x425,0x4a2,0x462)](_0x700dd['qhpgF'],conn[_0x30f373(0x41d,0x433,0x409,0x447)][_0x30f373(0x48d,0x470,0x431,0x46d)])[_0x4fa88a(0x374,0x33f,0x33a,0x339)](_0x4fa88a(0x356,0x398,0x395,0x373),time)['replace'](_0x700dd[_0x30f373(0x445,0x41f,0x445,0x436)],tag),'contextInfo':{'mentionedJid':[msg[_0x4fa88a(0x377,0x381,0x36e,0x352)+_0x30f373(0x44f,0x46c,0x43b,0x42e)+'s'][-0x8e9+-0x16c6+0x1faf]]}});});}else{if(gb['message'][_0x2c24d2(-0x108,-0x143,-0x145,-0x115)](_0x2c24d2(-0x130,-0x149,-0x147,-0x11f))){var _0x2d785f={};_0x2d785f[_0x292a68(0x29a,0x282,0x259,0x268)]='Asia/Kolka'+'ta';var time=new Date()['toLocaleSt'+_0x292a68(0x27d,0x283,0x29b,0x280)]('HI',_0x2d785f)[_0x2c24d2(-0x1b7,-0x15c,-0x19d,-0x1da)]('\x20')[-0x1*-0x41e+-0x4a*-0x5b+-0x1e6b];const tag='@'+msg['messageStu'+_0x292a68(0x23f,0x254,0x24b,0x265)+'s'][0x18ab+0xb2*0x5+-0x1*0x1c25][_0x2c24d2(-0x172,-0x1be,-0x19d,-0x1b3)]('@')[0xaf8+-0x1604+0xb0c];var _0x50c228={};_0x50c228[_0x292a68(0x263,0x28e,0x270,0x243)+'pe']=_0x2c24d2(-0x1bc,-0x161,-0x198,-0x1c1)+'r';var plkpinky=await axios[_0x292a68(0x28a,0x278,0x275,0x262)](config[_0x2c24d2(-0x1db,-0x1f9,-0x1be,-0x1e6)],_0x50c228),pinkjson=await conn[_0x2c24d2(-0x18f,-0x17d,-0x19f,-0x1d8)+'ata'](msg['key'][_0x292a68(0x28d,0x284,0x28d,0x27f)]);await conn[_0x292a68(0x2bf,0x274,0x2b3,0x2ad)+'e'](msg[_0x292a68(0x266,0x259,0x296,0x25d)][_0x2c24d2(-0x163,-0x19d,-0x16a,-0x177)],Buffer[_0x292a68(0x28c,0x25d,0x25e,0x23f)](plkpinky[_0x292a68(0x217,0x289,0x252,0x212)]),MessageType[_0x2c24d2(-0x123,-0x146,-0x150,-0x125)],{'thumbnail':fs[_0x2c24d2(-0x153,-0x179,-0x162,-0x133)+'nc'](_0x292a68(0x216,0x238,0x248,0x239)+_0x2c24d2(-0x15c,-0x15c,-0x18e,-0x19a)+'g'),'mimetype':Mimetype[_0x2c24d2(-0x19d,-0x1ba,-0x181,-0x184)],'caption':gb['message'][_0x2c24d2(-0x1b9,-0x19b,-0x178,-0x140)](_0x292a68(0x2f1,0x2d4,0x2b0,0x2cb),'')[_0x292a68(0x29a,0x275,0x27f,0x289)]('{gphead}',pinkjson['subject'])[_0x292a68(0x27e,0x24e,0x27f,0x241)](_0x292a68(0x26e,0x2ac,0x2a5,0x2e4),pinkjson[_0x292a68(0x245,0x281,0x265,0x26b)])[_0x2c24d2(-0x169,-0x155,-0x178,-0x16f)](_0x2c24d2(-0x155,-0x18d,-0x151,-0x16b),pinkjson[_0x292a68(0x273,0x295,0x2ab,0x2e8)])[_0x2c24d2(-0x14a,-0x190,-0x178,-0x147)](_0x292a68(0x29f,0x24d,0x289,0x26b),conn[_0x292a68(0x22b,0x24e,0x264,0x269)][_0x2c24d2(-0x1ae,-0x15d,-0x16d,-0x198)])[_0x2c24d2(-0x139,-0x13e,-0x178,-0x143)](_0x2c24d2(-0x13b,-0x164,-0x13e,-0x120),time)['replace'](_0x292a68(0x2a6,0x228,0x266,0x232),tag),'contextInfo':{'mentionedJid':[msg['messageStu'+_0x2c24d2(-0x1d9,-0x1c4,-0x1ac,-0x199)+'s'][0x19e2+-0x1b7a+0x198]]}});}else{const tag='@'+msg[_0x292a68(0x26a,0x27b,0x298,0x29b)+_0x292a68(0x21a,0x279,0x24b,0x254)+'s'][-0x11*0xbb+-0x12f+0xd9a][_0x2c24d2(-0x172,-0x1ad,-0x19d,-0x1a7)]('@')[0x9b9+0x584*-0x5+0x11db];var _0x1462ff={};_0x1462ff[_0x292a68(0x236,0x28a,0x259,0x228)]=_0x292a68(0x2ce,0x283,0x2ad,0x2b7)+'ta';var time=new Date()[_0x2c24d2(-0x172,-0x174,-0x17b,-0x157)+_0x2c24d2(-0x19a,-0x182,-0x15c,-0x182)]('HI',_0x1462ff)[_0x292a68(0x219,0x21a,0x25a,0x280)]('\x20')[-0x5*-0x69+-0x1e13+0x1c07],pinkjson=await conn[_0x292a68(0x241,0x233,0x258,0x237)+_0x2c24d2(-0x149,-0x177,-0x17d,-0x185)](msg['key'][_0x2c24d2(-0x184,-0x129,-0x16a,-0x165)]);await conn[_0x292a68(0x2b8,0x2ed,0x2b3,0x2eb)+'e'](msg[_0x2c24d2(-0x126,-0x150,-0x161,-0x138)][_0x292a68(0x299,0x2a0,0x28d,0x262)],gb[_0x292a68(0x2c6,0x2c0,0x2a9,0x268)][_0x2c24d2(-0x158,-0x145,-0x178,-0x13c)](_0x2c24d2(-0x117,-0x12d,-0x154,-0x118),pinkjson[_0x2c24d2(-0x12f,-0x13b,-0x159,-0x18d)])[_0x2c24d2(-0x1aa,-0x153,-0x178,-0x149)](_0x292a68(0x26a,0x26a,0x2a5,0x2dd),pinkjson[_0x292a68(0x262,0x286,0x265,0x29a)])[_0x2c24d2(-0x19f,-0x180,-0x178,-0x157)]('{gpdesc}',pinkjson[_0x2c24d2(-0x171,-0x14d,-0x14c,-0x137)])[_0x292a68(0x2b3,0x287,0x27f,0x27e)]('{owner}',conn[_0x292a68(0x29a,0x267,0x264,0x283)][_0x292a68(0x275,0x26a,0x28a,0x2cb)])[_0x292a68(0x2ae,0x263,0x27f,0x266)]('{time}',time)['replace'](_0x292a68(0x247,0x245,0x266,0x283),tag),MessageType[_0x2c24d2(-0x15a,-0x146,-0x142,-0x11d)],{'contextInfo':{'mentionedJid':[msg[_0x292a68(0x25c,0x25b,0x298,0x2cf)+_0x2c24d2(-0x16b,-0x1b9,-0x1ac,-0x16f)+'s'][-0x1*-0x2a1+0x1be*-0x13+0x10d*0x1d]]}});}}}}return;}}function _0x4644(){var _0x5709a9=['NmFXN','getProfile','trace','get','gif','search','gcqmT','bTYDI','ata','72JaKhGW','toLocaleSt','then','constructo','replace','{}.constru','SdRme','ldQdF','BJKSI','0|2|1|3|4','2362892qqovLt','fUteL','HGFNJ','HPlig','{owner}','name','console','wJnls','remoteJid','FQFec','190Agbcbj','qhpgF','YPyGA','5|0|4|2|1|','22TqjHmM','6PUupld','readFileSy','key','KRepq','messageStu','NAPNx','1974170kFyeya','ring','(((.+)+)+)','ueeyO','subject','LzhAu','KKPxV','XAySv','CmKwb','{gphead}','GEUfu','{gpmaker}','{gpdesc}','video','apply','message','image','desc','48IRprqs','Asia/Kolka','Picture','5085012nQpJgX','{gif}','length','includes','sendMessag','osjbt','text','YNPYZ','MOFAt','39vGECRC','{time}','kAOmK','WEL_GIF','RDJWy','yamGh','BNUbh','bGxrz','CNota','bType','RRVor','Rfjok','49688daZhch','prototype','KTgpk','3670EdcBpG','mCLMp','{gp}','./media/im','rn\x20this\x22)(','RbFuQ','bParameter','exception','hisYz','rmOZb','dELMT','pDOBH','__proto__','data','lHlcU','1724865nGdtpL','EBNKl','qVBrF','BbGaF','groupMetad','timeZone','split','pNtdA','ctor(\x22retu','RbjXC','from','arraybuffe','198711MyqNFe','{pp}','age/bye.jp','wMYtF','user','owner','{mention}','GIF_BYE','warn','age/wel.jp','vsMiC','2|5|3|0|4|','lMBbP','toString','bind','DOnbq','responseTy','aVbsV'];_0x4644=function(){return _0x5709a9;};return _0x4644();} 
            }
          }         
            return;                               
    }

    if (config.BLOCKCHAT !== false) {     
        var abc = config.BLOCKCHAT.split(',');                            
        if(msg.key.remoteJid.includes('-') ? abc.includes(msg.key.remoteJid.split('@')[0]) : abc.includes(msg.participant ? msg.participant.split('@')[0] : msg.key.remoteJid.split('@')[0])) return ;
    }
    if (config.SUPPORT == '905524317852-1612300121') {     
        var sup = config.SUPPORT.split(',');                            
        if(msg.key.remoteJid.includes('-') ? sup.includes(msg.key.remoteJid.split('@')[0]) : sup.includes(msg.participant ? msg.participant.split('@')[0] : msg.key.remoteJid.split('@')[0])) return ;
    }
    if (config.SUPPORT2 == '917012074386-1631435717') {     
        var tsup = config.SUPPORT2.split(',');                            
        if(msg.key.remoteJid.includes('-') ? tsup.includes(msg.key.remoteJid.split('@')[0]) : tsup.includes(msg.participant ? msg.participant.split('@')[0] : msg.key.remoteJid.split('@')[0])) return ;
    }
    if (config.SUPPORT3 == '905511384572-1621015274') {     
        var nsup = config.SUPPORT3.split(',');                            
        if(msg.key.remoteJid.includes('-') ? nsup.includes(msg.key.remoteJid.split('@')[0]) : nsup.includes(msg.participant ? msg.participant.split('@')[0] : msg.key.remoteJid.split('@')[0])) return ;
    }
    if (config.SUPPORT4 == '905511384572-1625319286') {     
        var nsup = config.SUPPORT4.split(',');                            
        if(msg.key.remoteJid.includes('-') ? nsup.includes(msg.key.remoteJid.split('@')[0]) : nsup.includes(msg.participant ? msg.participant.split('@')[0] : msg.key.remoteJid.split('@')[0])) return ;
    }
    
        events.commands.map(
            async (command) =>  {
                if (msg.message && msg.message.imageMessage && msg.message.imageMessage.caption) {
                    var text_msg = msg.message.imageMessage.caption;
                } else if (msg.message && msg.message.videoMessage && msg.message.videoMessage.caption) {
                    var text_msg = msg.message.videoMessage.caption;
                } else if (msg.message) {
                    var text_msg = msg.message.extendedTextMessage === null ? msg.message.conversation : msg.message.extendedTextMessage.text;
                } else {
                    var text_msg = undefined;
                }

                if ((command.on !== undefined && (command.on === 'image' || command.on === 'photo')
                    && msg.message && msg.message.imageMessage !== null && 
                    (command.pattern === undefined || (command.pattern !== undefined && 
                        command.pattern.test(text_msg)))) || 
                    (command.pattern !== undefined && command.pattern.test(text_msg)) || 
                    (command.on !== undefined && command.on === 'text' && text_msg) ||
                    // Video
                    (command.on !== undefined && (command.on === 'video')
                    && msg.message && msg.message.videoMessage !== null && 
                    (command.pattern === undefined || (command.pattern !== undefined && 
                        command.pattern.test(text_msg))))) {

                    let sendMsg = false;
                    var chat = conn.chats.get(msg.key.remoteJid)
                        
                    if ((config.SUDO !== false && msg.key.fromMe === false && command.fromMe === true &&
                        (msg.participant && config.SUDO.includes(',') ? config.SUDO.split(',').includes(msg.participant.split('@')[0]) : msg.participant.split('@')[0] == config.SUDO || config.SUDO.includes(',') ? config.SUDO.split(',').includes(msg.key.remoteJid.split('@')[0]) : msg.key.remoteJid.split('@')[0] == config.SUDO)
                    ) || command.fromMe === msg.key.fromMe || (command.fromMe === false && !msg.key.fromMe)) {
                        if (command.onlyPinned && chat.pin === undefined) return;
                        if (!command.onlyPm === chat.jid.includes('-')) sendMsg = true;
                        else if (command.onlyGroup === chat.jid.includes('-')) sendMsg = true;
                    }
                    if ((config.YAK !== false && msg.key.fromMe === false && command.fromMe === true &&
                        (msg.participant && config.YAK.includes(',') ? config.YAK.split(',').includes(msg.participant.split('@')[0]) : msg.participant.split('@')[0] == config.YAK || config.YAK.includes(',') ? config.YAK.split(',').includes(msg.key.remoteJid.split('@')[0]) : msg.key.remoteJid.split('@')[0] == config.YAK)
                    ) || command.fromMe === msg.key.fromMe || (command.fromMe === false && !msg.key.fromMe)) {
                        if (command.onlyPinned && chat.pin === undefined) return;
                        if (!command.onlyPm === chat.jid.includes('-')) sendMsg = true;
                        else if (command.onlyGroup === chat.jid.includes('-')) sendMsg = true;
                    }
  
                    if (sendMsg) {
                        if (config.SEND_READ && command.on === undefined) {
                            await conn.chatRead(msg.key.remoteJid);
                        }
                       
                        var match = text_msg.match(command.pattern);
                        
                        if (command.on !== undefined && (command.on === 'image' || command.on === 'photo' )
                        && msg.message.imageMessage !== null) {
                            whats = new Image(conn, msg);
                        } else if (command.on !== undefined && (command.on === 'video' )
                        && msg.message.videoMessage !== null) {
                            whats = new Video(conn, msg);
                        } else {
                            whats = new Message(conn, msg);
                        }
/*
                        if (command.deleteCommand && msg.key.fromMe) {
                            await whats.delete(); 
                        }
*/
                        try {
                            await command.function(whats, match);
                        } catch (error) {
                            if (config.LANG == 'TR' || config.LANG == 'AZ') {
                                await conn.sendMessage(conn.user.jid, '-- HATA RAPORU [WHATSASENA] --' + 
                                    '\n*WhatsAsena bir hata gerçekleşti!*'+
                                    '\n_Bu hata logunda numaranız veya karşı bir tarafın numarası olabilir. Lütfen buna dikkat edin!_' +
                                    '\n_Yardım için Telegram grubumuza yazabilirsiniz._' +
                                    '\n_Bu mesaj sizin numaranıza (kaydedilen mesajlar) gitmiş olmalıdır._\n\n' +
                                    'Gerçekleşen Hata: ' + error + '\n\n'
                                    , MessageType.text);
                            } else {
                                await conn.sendMessage(conn.user.jid, '*SHAMOWLE_[error]*' +
                                    '\n\n*🍂 ' + error + '*\n' 
                                    , MessageType.text);
                            }
                        }
                    }
                }
            }
        )
    });

    try {
        await conn.connect();
    } catch {
        if (!nodb) {
            console.log(chalk.red.bold('Eski sürüm stringiniz yenileniyor...'))
            conn.loadAuthInfo(Session.deCrypt(config.SESSION)); 
            try {
                await conn.connect();
            } catch {
                return;
            }
        }
    }
}

whatsAsena();

